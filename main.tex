% arara: pdflatex: { synctex: yes }
% arara: makeindex: { style: ctuthesis }
% arara: bibtex

% The class takes all the key=value arguments that \ctusetup does,
% and a couple more: draft and oneside
\documentclass[twoside]{ctuthesis}


\usepackage[utf8]{inputenc}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{tikz}
\usetikzlibrary{shapes.geometric}
\usetikzlibrary{arrows.meta,arrows}
\usepackage[demo,abs]{overpic}
% Pictures
\usepackage{graphicx,import}
\graphicspath{ {images/svg/} {images/svg/otopna-soustava/} {images/svg/software/}}
% Table
\usepackage{multirow}
\usepackage{slashbox}

\usepackage{makecell}
\renewcommand\theadfont{\bfseries}


% Notes
\usepackage{threeparttable}

% List of terms and abbreviations
\usepackage[automake,acronym,nonumberlist]{glossaries}

% Bibtex
% Zalomeni dlouheho url
\usepackage{xurl}

% Zamezeni parchantum
\usepackage{nowidow}

% Vlozeni PDF souboru
\usepackage{pdfpages}

% Balicek na posunuti cislovani stranek u PDF prilohy
\usepackage{fancyhdr}
% Importovani text souboru z podslozek
\usepackage{import}

% Rotace obrázku pro blokové schéma HA
\usepackage{rotating}
%\usepackage{tikz}




\ctusetup{
	%preprint = \ctuverlog,
%	mainlanguage = english,
	titlelanguage = czech,
	mainlanguage = czech,
	otherlanguages = {slovak,english},
	title-czech = {Systém pro podlahové vytápění rodinného domu pomocí zónové regulace},
	title-english = {System for underfloor heating of a family house using zone control},
%	subtitle-czech = {Cesta do tajů kdovíčeho},
%	subtitle-english = {Journey to the who-knows-what wondeland},
	doctype = M,
	faculty = F3,
	department-czech = {Katedra mikroelektroniky},
	department-english = {Department of Microelectronics},
	author = {Bc. Roman Labovský},
	supervisor = {Ing. Vladimír Janíček, Ph.D.},
	supervisor-address = {České vysoké učení technické v Praze, Fakulta elektrotechnická, Katedra mikroelektroniky\\ Technická 2, \\ Praha 6 \\ 166 27},
%	supervisor-specialist = {John Doe},
	fieldofstudy-english = {Electronics},
	subfieldofstudy-english = {Electronics and Communication},
	fieldofstudy-czech = {Elektronika},
	subfieldofstudy-czech = {Elektronika a komunikace},
	keywords-czech = {termostat, Home Assistant, zónová regulace vytápění, podlahové vytápění, Power over Ethernet, ESP32 },
	keywords-english = {thermostat, Home Assistant, zone heating control, underfloor heating, Power over Ethernet, ESP32},
	day = 3,
	month = 1,
	year = 2022,
	specification-file = {zadani-dp.pdf},
	front-specification = true,
%	front-list-of-figures = false,
%	front-list-of-tables = false,
%	monochrome = true,
%	layout-short = true,
	pkg-listings = true,
}

\ctuprocess

\addto\ctucaptionsczech{%
	\def\supervisorname{Vedoucí}%
	\def\subfieldofstudyname{Studijní program}%
}

\ctutemplateset{maketitle twocolumn default}{
	\begin{twocolumnfrontmatterpage}	
		\ctutemplate{twocolumn.thanks}
		\ctutemplate{twocolumn.declaration}
		\ctutemplate{twocolumn.abstract.in.titlelanguage}
		\ctutemplate{twocolumn.abstract.in.secondlanguage}
		\ctutemplate{twocolumn.tableofcontents}
		\ctutemplate{twocolumn.listoffigures}
	\end{twocolumnfrontmatterpage}
}

% Posunuti cislovani stranky dolu u vlozenych PDF (priloha)
\fancypagestyle{includedpages}{%
  \fancyhf{}%
  \renewcommand{\headrulewidth}{0pt}%
  \setlength{\footskip}{70pt}
  \fancyfoot[C]{\thepage}%
}

% Seznam prilohy
\newcommand\listappendixname{Seznam příloh}
\newcommand\appcaption[1]{%
   \addcontentsline{app}{chapter}{#1}}
\makeatletter
\newcommand\listofappendices{%
   \section*{\listappendixname}\@starttoc{app}}

% Diakritika pro listings (zapis kodu)
\lstset{
     literate=%
         {á}{{\'a}}1
         {í}{{\'i}}1
         {é}{{\'e}}1
         {ý}{{\'y}}1
         {ú}{{\'u}}1
         {ó}{{\'o}}1
         {ě}{{\v{e}}}1
         {š}{{\v{s}}}1
         {č}{{\v{c}}}1
         {ř}{{\v{r}}}1
         {ž}{{\v{z}}}1
         {ď}{{\v{d}}}1
         {ť}{{\v{t}}}1
         {ň}{{\v{n}}}1                
         {ů}{{\r{u}}}1
         {Á}{{\'A}}1
         {Í}{{\'I}}1
         {É}{{\'E}}1
         {Ý}{{\'Y}}1
         {Ú}{{\'U}}1
         {Ó}{{\'O}}1
         {Ě}{{\v{E}}}1
         {Š}{{\v{S}}}1
         {Č}{{\v{C}}}1
         {Ř}{{\v{R}}}1
         {Ž}{{\v{Z}}}1
         {Ď}{{\v{D}}}1
         {Ť}{{\v{T}}}1
         {Ň}{{\v{N}}}1                
         {Ů}{{\r{U}}}1    
}

% Theorem declarations, this is the reasonable default, anybody can do what they wish.
% If you prefer theorems in italics rather than slanted, use \theoremstyle{plainit}
\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[chapter]
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}

\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
%\newtheorem{example}[theorem]{Example}
\newtheorem{conjecture}[theorem]{Conjecture}

\theoremstyle{note}
\newtheorem*{remark*}{Remark}
\newtheorem{remark}[theorem]{Remark}
% Velikost mezery mezi odstavci
\setlength{\parskip}{2.5ex plus 0.2ex minus 0.2ex}

% Abstract in Czech
\begin{abstract-czech}
Tato diplomová práce se zabývá problematikou regulace zónového podlahového vytápění rodinného domu. Pro řízení se využívá systém Home Assistant fungující na Raspberry Pi, který je ovladatelný přes webové rozhraní. V~rámci systému jsou vybraná nebo zhotovená zařízení pro ovládání jednotlivých částí zónové regulace vytápění a lokální snímače prostorové teploty. Následně je celý řídicí systém testován a používán v reálném prostředí.
\end{abstract-czech}

% Abstract in English
\begin{abstract-english}
This thesis deals with a system for regulation of zone heating of family house. Proposed control system is based on Raspberry Pi with the Home Assistant system. The unit is fully controllable via web. Devices for controlling individual parts of the heating zone control and local room temperature sensors were selected or made within the system.  The programmed system was eventually tested in real environment.
\end{abstract-english}

% Acknowledgements / Podekovani
\begin{thanks}
V prvé řadě bych chtěl poděkovat svému vedoucímu Ing. Vladimíru Janíčkovi, Ph.D. za odborné vedení práce, věcné připomínky a~vstřícnost při konzultacích.

Dále bych chtěl poděkovat svému kamarádovi Ing. Tomáši Janouškovi a jeho rodině za možnost aplikovat svou práci na jejich rodinném domě a především za trpělivost během nasazování systému.

Děkuji studentskému klubu Silicon Hill a~projektu „MacGyver – Bastlíři SH“ za umožnění přístupu k měřicímu vybavení, pájecí a~osazovací technice.
\end{thanks}

% Declaration / Prohlaseni
\begin{declaration}
Prohlašuji, že jsem předloženou práci vypracoval samostatně a že jsem uvedl veškeré použité informační zdroje v souladu s Metodickým pokynem o dodržování etických principů při přípravě vysokoškolských závěrečných prací.


V Praze, \ctufield{day}.~\monthinlanguage{title}~\ctufield{year}

% Podpis pod prohlasenim
\begin{flushright}
	\parbox{5cm}
	{
		\begin{center}
			\dotfill \\ Bc. Roman Labovský
		\end{center}
	}
\end{flushright}
\end{declaration}

% Only for testing purposes
\listfiles
\usepackage[pagewise]{lineno}
\usepackage{lipsum,blindtext}
\usepackage{mathrsfs} % provides \mathscr used in the ridiculous examples



\newacronym{mqtt}{MQTT}{Message Queuing Telemetry Transport}
\newacronym{usb}{USB}{Universal Serial Bus}
\newacronym{i2c}{I$^2$C}{Inter-Integrated Circuit}
\newacronym{ram}{RAM}{Random Access Memory}
\newacronym{led}{LED}{Light-Emitting Diode}
\newacronym{lcd}{LCD}{Liquid Crystal Display}
\newacronym{pwm}{PWM}{Pulse Width Modulation}
\newacronym{poe}{POE}{Power Over Ethernet}
\newacronym{m2m}{M2M}{Machine To Machine}
\newacronym{json}{JSON}{JavaScript Object Notation}
\newacronym{bjson}{BJSON}{Binary JavaScript Object Notation}
\newacronym{tcp/ip}{TCP/IP}{Transmission Control Protocol/Internet Protocol}
\newacronym{qos}{QoS}{Quality of Service}
\newacronym{ssl}{SSL}{Secure Sockets Layer}
\newacronym{tls}{TLS}{Transport Layer Security}
\newacronym{scl}{SCL}{Synchronous Clock}
\newacronym{sda}{SDA}{Synchronous Data}
\newacronym{rom}{ROM}{Read Only Memory}
\newacronym{api}{API}{Application Programming Interface}
\newacronym{ha}{HA}{Home Assistant}
\newacronym{lan}{LAN}{Local Area Network}

\newacronym{tuv}{TUV}{Teplá užitková voda}
\newacronym{dps}{DPS}{Deska plošných spojů}
\newacronym{nc}{NC}{Normally Closed}


\newacronym{pse}{PSE}{Power Sourcing Equipment}
\newacronym{pd}{PD}{Powered Device}
\newacronym{ldo}{LDO}{Low-dropout regulator}
\newacronym{rmii}{RMII}{Reduced Media­-Independent Interface}
\newacronym{pet-g}{PET-G}{Polyethylentereftalát, „G“ znamená modifikovaný glykol}
\newacronym{dtr}{DTR}{Data Terminal Ready}
\newacronym{rts}{RTS}{Request To Send}
\newacronym{yaml}{YAML}{YAML Ain't Markup Language }
\newacronym{esd}{ESD}{Electrostatic discharge}

\newacronym{utp}{UTP}{Unshielded Twisted Pair}
\newacronym{uart}{UART}{Universal Asynchronous Receiver-Transmitter}
\newacronym{tvs}{TVS}{Transient Voltage Suppressor}
\newacronym{ptc}{PTC}{Positive Temperature Coefficient}
\newacronym{ntc}{NTC}{Negative Temperature Coefficient}

\newacronym{zov}{ZOV}{Zásobník otopné vody}
\newacronym{nspt}{NSPT}{Nástěnný snímač prostorové teploty}




\makeglossaries
\renewcommand{\acronymname}{Seznam použitých zkratek a symbolů}

% Redukovani automaticky mezer mezi odstavci
\clubpenalty=10000
\widowpenalty=10000
\raggedbottom

% PDF informace
\hypersetup{pdfauthor   = Roman Labovský,
            pdftitle    = Systém pro podlahové vytápění rodinného domu pomocí zónové regulace,
            pdfsubject  = Diplomová práce,
            pdfkeywords = {termostat, Home Assistant, zónová regulace vytápění, podlahové vytápění, Power over Ethernet, ESP32},
            pdfproducer = Texmaker 5.0.4,
            pdfcreator  = LaTeX editor}

\begin{document}

\maketitle

\printglossaries


\input{introduction}

\input{search}
\input{draft-of-concept}


\input{choosing-of-components-devices}

\input{software-part}

\input{testing}

\input{suggest-further-improvements}



%\blindmathtrue

%\blinddocument

\input{conclusion}

\input{bibliography}

\appendix

\listofappendices

%\printindex

\chapter{Schéma -- Nástěnný snímač prostorové teploty s Ethernetem}\appcaption{A Schéma -- Nástěnný snímač prostorové teploty s Ethernetem}
\label{app:nastenny-snimac-prostorove-teploty-ethernet}
\includepdf[pages=-,angle=90,pagecommand={\thispagestyle{includedpages}}]{appendix/nastenny-snimac-prostorove-teploty-ethernet/esp32-periferie.pdf}
\includepdf[pages=-,angle=90,pagecommand={\thispagestyle{includedpages}}]{appendix/nastenny-snimac-prostorove-teploty-ethernet/ethernet.pdf}
\includepdf[pages=-,angle=90,pagecommand={\thispagestyle{includedpages}}]{appendix/nastenny-snimac-prostorove-teploty-ethernet/napajeni.pdf}


\chapter{Schéma -- Nástěnný snímač prostorové teploty s WiFi}
\appcaption{B Schéma -- Nástěnný snímač prostorové teploty s WiFi}
\label{app:nastenny-snimac-prostorove-teploty-wifi}
\includepdf[pages=-,angle=90,pagecommand={\thispagestyle{includedpages}}]{appendix/nastenny-snimac-prostorove-teploty-wifi/esp32-periferie.pdf}
\includepdf[pages=-,angle=90,pagecommand={\thispagestyle{includedpages}}]{appendix/nastenny-snimac-prostorove-teploty-wifi/napajeni.pdf}




\chapter{Schéma -- Ostatní}
\appcaption{C Schéma -- Ostatní}
\label{app:schemata-ostatni}
\includepdf[pages=-,angle=90,pagecommand={\thispagestyle{includedpages}}]{appendix/1-wire-koncove-zarizeni/1-wire-1-koncove-zarizeni.pdf}
\includepdf[pages=-,angle=90,pagecommand={\thispagestyle{includedpages}}]{appendix/1-wire-koncove-zarizeni/1-wire-6-koncovych-zarizeni.pdf}

\includepdf[pages=-,angle=90,pagecommand={\thispagestyle{includedpages}}]{appendix/modul-pca9615.pdf}
\includepdf[pages=-,angle=90,pagecommand={\thispagestyle{includedpages}}]{appendix/rozbocovac-i2c.pdf}

\includepdf[pages=-,angle=90,pagecommand={\thispagestyle{includedpages}}]{appendix/vstupy-vystupy-rpi.pdf}

\includepdf[pages=-,angle=90,pagecommand={\thispagestyle{includedpages}}]{appendix/krbova-indikace-1-wire-ochrana-napajeni.pdf}
\includepdf[pages=-,angle=90,pagecommand={\thispagestyle{includedpages}}]{appendix/modul-max31850k.pdf}

\includepdf[pages=-,angle=90,pagecommand={\thispagestyle{includedpages}}]{appendix/zonovy-regulator/ochrany-napajeni-24v-5v.pdf}
\includepdf[pages=-,angle=90,pagecommand={\thispagestyle{includedpages}}]{appendix/zonovy-regulator/svorkovnice-termoelektricke-pohony.pdf}
\includepdf[pages=-,angle=90,pagecommand={\thispagestyle{includedpages}}]{appendix/zonovy-regulator/pca9685.pdf}

\includepdf[pages=-,angle=90,pagecommand={\thispagestyle{includedpages}}]{appendix/rele-modul-jeden-kanal.pdf}

\includepdf[pages=-,angle=90,pagecommand={\thispagestyle{includedpages}}]{appendix/prevodnik-usb-uart.pdf}



\chapter{Krabička pro nástěnný snímač prostorové teploty}
\appcaption{D Krabička pro nástěnný snímač prostorové teploty}
\label{app:krabicka-pro-nastenny-snimac-prostorove-teploty}
\subimport{appendix}{box-wall-sensor-of-room-temperature.tex}

\chapter{Rozdělovač podlahového vytápění}
\appcaption{E Rozdělovač podlahového vytápění}
\label{app:rozdelovac-podlahoveho-vytapeni}
\subimport{appendix}{distributor-first-floor.tex}

\chapter{Ostatní}
\appcaption{F Ostatní}
\label{app:ostatni}
\subimport{appendix}{i2c-module.tex}
\subimport{appendix}{i2c-hub.tex}
\subimport{appendix/software}{block-scheme-wall-sensor-of-room-temperature.tex}

\chapter{Doplňující informace}
\appcaption{G Doplňující informace}
\label{doplnujici-informace}
\subimport{appendix}{additional-information.tex}


\chapter{Obsah CD}
\appcaption{H Obsah CD}
\label{app:obsah-cd}
\subimport{appendix}{content-of-cd.tex}

%\bibliographystyle{amsalpha}
%\bibliography{ctutest}
%\printbibliography



\end{document}