\chapter{Závěr}
Podle zadání diplomové práce se mi povedly splnit všechny body. Cílem práce bylo prostudovat problematiku zónového podlahového vytápění a navrhnout vlastní řešení pro řízení dílčích částí systému. Navrhl jsem koncept centrální jednotky a dalších částí pro zónovou regulaci vytápění. Navrhl jsem koncept komunikace centrální jednotky, lokálních \acrshort{nspt} a~akčních členů pro řízení jednotlivých otopných okruhů. Na základě konceptu jsem zvolil centrální jednotku, navrhl jednotlivá zařízení pro dané části systému včetně jejich mechanického umístění a ochranných krabiček. Některé části jsem zakoupil hotové a~případně je upravil. V~rámci problematiky POE jsem navrhl DC/DC měnič pro PSE zařízení. Dalším splněným bodem zadání je zvolená vhodná komunikace a zejména jednoduchá rozšiřitelnost. Na centrální jednotce funguje open-source řídicí systém pro domácí automatizaci. Tento systém je neustále rozšiřován a aktualizován vývojářskou komunitou. Má již mnoho integrovaných částí pro řízení vytápění. V~rámci komunikace mezi centrální jednotkou a~\acrshort{nspt} byla zvolena komunikace pomocí MQTT, která je snadno nastavitelná a snadno rozšiřitelná. Mezi centrální jednotkou a akčními členy se využívá standardní I$^2$C sběrnice s úpravou pro komunikaci na delší vzdálenosti. Teplotní senzory jsou připojené na 1-Wire sběrnici. Zhotovil jsem \acrshort{nspt} do jednotlivých místností ve verzi s POE a WiFi s napájením pomocí síťového adaptéru. Pro \acrshort{nspt} jsem navrhl a~zhotovil krabičku pomocí 3D tiskárny. Pro ovládání jednotlivých otopných okruhů jsem zhotovil vlastní řešení s využitím zakoupených termoelektrických pohonů. V rámci celého systému se využívá automatizovaná část (inteligentní část) spočívající využívání teplotních plánů s možností jejich modifikování na základě teplotní predikce, kterou jsem do systému implementoval. Využívají se nasbíraná data z~jednotlivých místností v~rámci vytápění a~na základě nich se sestavuje velmi jednoduchá lineární predikce s předpovědí počasí pro úpravu časových teplotních úseků, aby v~požadovaný čas bylo dosaženo požadované teploty. Dále se využívá softwarová detekce otevřeného okna pro pozastavení vytápění v případě otevření okna. Vše jsem následně otestoval a nainstaloval v rodinném domě. Systém se dá neustále rozšiřovat pro případné požadované úpravy. Vše jsem upravil podle požadavků uživatelů domácnosti. 

Celý systém řízení se postupně vyvíjel. Původně bylo řízení vytápění podle chodbových termostatů a nepočítalo se se zónovým řízením podlahového vytápění, na které se následně přešlo. Majitel domu chtěl primárně veškeré řešení drátové. Nakonec jsme vymysleli, jak rozvést kabely do jednotlivých místností. Vznikly primárně POE \acrshort{nspt}, využili jsme půdu pro rozvedení UTP kabelu do všech místností, kde to bylo možné a~zároveň nebyla ničena estetika místnosti. Pro místnosti, kde to nebylo možné, jsem navrhl bezdrátové moduly (WiFi) s~napájením ze síťových adaptérů, aby nebylo nutné se starat o výměnu baterií, což byl požadavek majitele. Jistou nevýhodou by mohly být bezdrátové moduly z~pohledu komunikace a případných výpadků. Vzhledem k~dobrému pokrytí WiFi sítě v~domě je komunikace bezproblémová. Celkové náklady na celý systém jsou po zaokrouhlení 37 000 Kč. Nezanedbatelnou část kalkulace tvoří termoelektrické pohony (celkově 2~×~12 pohonů pro 1. a 2. druhé patro), která činí přibližně 10 000 Kč. Cenové srovnání s~komerčními systémy nedává úplně smysl. Cenová kalkulace se týká pouze součástek a nejsou v ní zahrnuty náklady například na samotný vývoj, kancelářské místnosti, splnění legislativních povinností, certifikace a mnohé jiné. Rozpis jednotlivých součástek a celková kalkulace je v příloze \ref{app:obsah-cd}.  Na verzi s POE jsou poněkud vyšší náklady na součástky, nicméně ty nejdražší mi zaslali výrobci jako vzorek.

DPS pro připojení 1-Wire sběrnice a chodbových termostatů k centrální jednotce (1 kus), I$^{2}$C rozdělovač (2 kusy), DPS pro signalizaci u krbů (3 kusy) a~DPS v rozdělovačích pro podlahové vytápění (2 kusy) jsem vlastnoručně vyrobil pomocí fotocesty a mokrého leptání. DPS pro \acrshort{nspt}(verze Ethernet 6 kusů, verze WiFi 5 kusů) jsem vyrobil ve specializované firmě. Následně ručně vyrobené i průmyslově vyrobené DPS jsem osadil a zapájel. Pro plastové krabičky jsem navrhl 3D model a vytiskl na 3D tiskárně. Zapojení rozvaděče v~technické místnosti i~jiných částech jsem též provedl vlastnoručně.

Celý systém jsem otestoval v reálných podmínkách rodinného domu. Otestoval jsem jak samotný hardware, tak i software. Využití teplotních plánů je plně funkční a usnadňuje uživatelům vytvoření teplotního komfortu v domě podle jejich potřeb. V případě využití teplotních plánů s teplotní predikcí dochází k vytápění na požadovanou teplotu v požadovaný čas bez zpoždění. Využívají se již naměřená data z minulosti a systém je tak automatizovaný. Uživatelé jsou upozorňováni na potřebu zatopení v krbu, jak pro potřeby vytápění či dobíjení TUV. Systém je již připraven na instalaci plynového kotle, tím bude systém plně automatizovaný a bude přispívat k uživatelskému, tak i teplotnímu komfortu v domě. Softwarové řešení detekce otevřeného okna se v praxi ověřila jako přínosná ve snížení nákladů na přebytečné vytápění.

V průběhu práce jsem narazil na několik problémů. Prvním problémem bylo správné zvolení impedančního zakončení diferenciální I$^{2}$C sběrnice, které po několikátém předělání nyní funguje bez problémů. Při tisknutí 3D krabičky vznikl problém se správným vytvořením podpěr v oblasti distančních sloupků, aby krabička šla vytisknout. Optimální řešení by bylo krabičku vytisknout bez distančních sloupků, respektive zvlášť a následně je nalepit. V rámci softwaru do \acrshort{nspt} jsem úspěšně vyřešil správné nastavení obnovení komunikace s centrální jednotkou v případě výpadku (odpojení centrální jednotky nebo odpojení \acrshort{nspt}).

Na celém systému jsem pracoval přes rok až do současného stavu. Systém funguje v objektu bez jediného výpadku. Vzhledem k dnešním vyšším cenám energií je celá problematika o to zajímavější a navržená implementace dobrým příkladem alternativních řešení řízení. Celá tato práce, dále kód pro automatizaci HA, kód pro ESP32 (nástěnné snímače prostorové teploty), 3D krabička, schémata zapojení a DPS jsou veřejné na mém GitHub účtu \mbox{\url{https://github.com/RomLab}} v~aktuální verzi. Projekt hodlám dále vyvíjet.

